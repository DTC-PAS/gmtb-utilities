Authors: Weiwei Li - NCAR/RAL (weiweili@ucar.edu). Some of the code and scripts were also supported by the projects led by Zhuo Wang (zhuowang@illinois.edu)

Purpose: 
1) calculate heat source (Q1; K/day) and moisture sink (Q2; K/day) based on Yanai et al. (1973) and Yanai and Tomita (1998). Note that the vertical velocity used in the caculation was from model output.
2) plot the relationships between relative humidity (RH; unit: percentage) and diabatic heating rate Q1 with the column water vapor (CWV; unit: mm). The relationship between humidity and convection is also a central issue of many cumulus schemes. 

Notes: The scripts currently assumed using model output in GRIB1/2 format and were tested using FV3GFSv1 forecasts


*********************************
General Steps and Inputs/Outputs:

1. calculate Q1 and Q2

a) edit Q1Q2.sh as needed 
cd Q1Q2
# c-shell script to calculate heat source Q1 and moisture sink Q2 (Yanai et al. 1973)
# !!!!!! What should be modified !!!!!!
# HHH  : home directory
# XXX  : number of grid in longitude
# YYY  : number of grid in latitude
# SZZ : number of selected vertical levels
# LSZZ: list of selected vertical levels (use grib_dump to check) 
# TTT  : number of total time (in day) within a season of a calendar year
# DDD  : time interval in second for calculating dx/dt 
# LAT0 : southernmost latitude
# LON0 : westernmost longitude
# GRDX : resolution in x-direction
# GRDY : resolution in y-direction
# FFF  : number of selected forecast lead times 
# LFF  : list of selected forecast lead times
# BYY  : first year 
# EYY  : last year 
# BMM  : first month
# EMM  : last month

b) make the script executable:
chmod 754 Q1Q2.sh

c) run the script:
./Q1Q2.sh


2. diagnose the relationships between RH or Q1 with CWV

a) edit RHQ1vsCWV.sh as needed
# !!!!!! What should be modified !!!!!!
# MMM  : model name
# HHH  : home directory
# VAR  : variables to analyze, e.g. RH and Q1
# XXX  : number of grid in longitude
# YYY  : number of grid in latitude
# SZZ1 : number of selected vertical levels for RH or Q1
# LSZZ1: list of selected vertical levels for RH or Q1 (use grib_dump to check) 
# SZZ2 : number of selected vertical levels for CWV
# LSZZ2: list of selected vertical levels for CWV (grib_dump to check) 
# TTT  : number of total time (in day)
# NBB  : number of basins or regions examined
# LATb : southern bound of latitude of studied domain
# LATe : northern bound of latitude of studied domain
# LONb : western bound of latitude of studied domain
# LONe : eastern bound of latitude of studied domain
# LAT0 : southernmost latitude
# LON0 : westernmost longitude
# GRD  : resolution
# FFF  : number of selected forecast lead times 
# LFF  : list of selected forecast lead times
# BYY  : first year 
# EYY  : last year 
# BMM  : first month
# EMM  : last month
# VRH  : shortname of precipitation in GRIB file
# VPW  : shortname of CWV in GRIB file
# VLS  : shortname of landmask in GRIB file
# NBIN : number of bins to stratify CWV
# CWV0 : minimum value of CWV
# CWV1 : maximum value of CWV
# Contact: Weiwei Li (weiweili@ucar.edu)

b) make the script executable:
chmod 754 RHQ1vsCWV.sh

c) run the script:
./RHQ1vsCWV.sh

